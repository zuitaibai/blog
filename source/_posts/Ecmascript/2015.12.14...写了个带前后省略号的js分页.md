---
title: 写了个带前后省略号的js分页
date: 2015-12-14 11:53:49
updated: 2015-12-14 11:53:49
tags:
  - 分页
  - js
---


在网上搜索js分页的算法，接近于当下比较常见的那种形式的，怎么也找不到。无奈自己写了一个，依据了某些asp的分页实现并改编。以备后用并分享：

<!--more-->

# Code

{% fold %}
``` bash
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        .pagination{vertical-align:middle;}
        .pagination a,.pagination span{padding:0 5px;margin-right:5px;border: 1px solid #ddd;text-align:center;line-height:30px;display:inline-block;min-width:22px;color:#000; vertical-align:middle;}
        .pagination .pageem{line-height:32px;display:inline-block;vertical-align:middle;font-style:normal;color:#aaa;}
        .pagination .pageem1{margin-left:2em;margin-right:4px;}
        .pagination .pageem2{margin-left:5px;}
        .pagination a {text-decoration: none;}
        .pagination a:hover,.pagination a:active {border-color:#666;color: #000;}
        .pagination .pagefirst,.pagination .pageprev,.pagination .pagelast,.pagination .pagenext{font-size:12px;}
        .pagination .pageprev{margin-right:2em;}
        .pagination .pagenext{margin-left:2em;}
        .pagination .current {border-color:#FBFBFB;background:#FBFBFB;}
        .pagination .disabled {border: 1px solid #EEE;color: #DDD;}
        .pagination .pagepoints{border-color:transparent;}
        .pagination .pageselect{box-sizing:border-box;height:30px;vertical-align:middle;}
    </style>
</head>
<body>

<div id="a"></div>

<script>
/*
 * -- getPagination --
 * return: pagesHtml stringObject
 * params:
 *     totalItems:   [number]    总条数   (必选)
 *     opts      :   {...}       配置项对象(可选)
 *        |----- currentPage:                 [number]       [default:1]                //当前页
 *        |----- pageSize:                    [number]       [default:10]               //每页条数
 *        |----- adjacents:                   [number]       [default:2]                //折叠的前后的展示个数
 *        |----- ifNoLink:                    [boolean]      [default:false]            //是否禁用链接
 *        |----- ifShowSelect:                [boolean]      [default:false]            //是否显示下拉列表
 *        |----- ifShowPrevNext:              [boolean]      [default:true]             //是否显示上一页、下一页按钮
 *        |----- ifShowFirstLast:             [boolean]      [default:true]             //是否显示首页、尾页按钮
 *        |----- ellipsis:                    [string]       [default:'...']            //有折叠时，折叠的文字
 *        |----- targetPageUrlPart:           [string]       [default:'?foo=bar']       //分页链接的前半部分
 *        |----- wordPrev:                    [string]       [default:'< 上一页']        //上一页按钮的文字
 *        |----- wordNext:                    [string]       [default:'下一页 >']        //下一页按钮的文字
 *        |----- wordFirst:                   [string]       [default:'|<< 首 页']       //首页按钮的文字
 *        |----- wordLast:                    [string]       [default:'末 页 >>|']       //尾页按钮的文字
 *        |----- whenLteOnePageIfReturnEmpty: [boolean]      [default:false]             //当小于等于1页时，是否返回空（否则返回分页html）
 * use:
 *     var pageHtml= getPagination(563);
 *     var pageHtml= getPagination(563,{ currentPage:12 });
 *     var pageHtml= getPagination(563,{ currentPage:12, wordPrev:'上一页' });
 *     ele.innerHTML= pageHtml;
 *     console.log(pageHtml.totalPage);
 *     console.log(pageHtml.selectHtml);
 *
*/
function getPagination(totalItems,opts){

    function href(page){ return def.ifNoLink?'javascript:;':def.targetPageUrlPart+'&page='+page; }
    if(isNaN(totalItems)) return '';
    totalItems=Math.abs(+totalItems);
    var def={
        currentPage:1,
        pageSize:10,
        adjacents:2,
        ifNoLink:false,
        whenLteOnePageIfReturnEmpty:false,
        ifShowSelect:false,
        ifShowPrevNext:true,
        ifShowFirstLast:true,
        ellipsis:'...',
        targetPageUrlPart:'?foo=bar',
        wordPrev:'< 上一页',
        wordNext:'下一页 >',
        wordFirst:'|<< 首 页',
        wordLast: '末 页 >>|'
    };
    if(opts){ for(var i in opts) def[i]=opts[i]; }

    var prev= def.currentPage - 1,
        next = def.currentPage + 1,
        lastpage = Math.ceil(totalItems/def.pageSize),
        lpm1 = lastpage - 1,
        pagination = '',
        selects,
        counter,
        pts='<span class="pagepoints">'+def.ellipsis+'</span>';

    selects='<em class="pageem pageem1">跳到第</em><select class="pageselect" onchange="location.href=\''+def.targetPageUrlPart+'&page=\'+this.value;">';
    for(counter =1; counter<=lastpage; counter++) selects += '<option value="'+counter+'" '+(counter === def.currentPage?' selected':'')+'>'+counter+'</span>';
    selects += '</select><em class="pageem  pageem2">页</em>';
    lastpage<1 && (selects='', lastpage=1);

    if(lastpage > 1){
        pagination += '<div class="pagination">';
        //first and previous button
        if(def.currentPage >1 ) {
            def.ifShowFirstLast && (pagination += '<a class="pagefirst" data-page="1" href="'+href(1)+'">'+def.wordFirst+'</a>'),
            def.ifShowPrevNext &&  (pagination  += '<a class="pageprev" data-page="'+prev+'" href="'+href(prev)+'">'+def.wordPrev+'</a>');
        }else{
            def.ifShowFirstLast && (pagination += '<span class="pagefirst disabled">'+def.wordFirst+'</span>'),
            def.ifShowPrevNext &&  (pagination +=  '<span class="pageprev disabled">'+def.wordPrev+'</span>');
        }
        //pages
        if(lastpage < 7 + (def.adjacents * 2)) {
            for (counter = 1; counter <= lastpage; counter++) {
                if (counter === def.currentPage) pagination += '<span class="current">' + counter + '</span>';
                else pagination += '<a data-page="'+counter+'" href="' +href(counter)+ '">' + counter + '</a>';
            }
        //enough pages to hide some
        }else if(lastpage >= 7 + (def.adjacents * 2)){
            //close to beginning only hide later pages
            if(def.currentPage < 1 + (def.adjacents * 3)){
                for(counter =1 ; counter<=(4 + (def.adjacents * 2))-1; counter++){
                    if(counter === def.currentPage) pagination +=  '<span class="current">'+counter+'</span>';
                    else pagination += '<a data-page="'+counter+'" href="'+href(counter)+'">'+counter+'</a>';
                }
                pagination +=  pts,
                pagination +=  '<a data-page="'+lpm1+'" href="'+href(lpm1)+'">'+lpm1+'</a>',
                pagination +=  '<a data-page="'+lastpage+'" href="'+href(lastpage)+'">'+lastpage+'</a>';
            //in middle hide some front and some back
            }else if(lastpage - (def.adjacents * 2) > def.currentPage && def.currentPage > (def.adjacents * 2)){
                pagination +=  '<a data-page="1" href="'+href(1)+'">1</a>',
            pagination +=  '<a data-page="2" href="'+href(2)+'">2</a>',
            pagination +=  pts;
                for(counter =def.currentPage - def.adjacents;counter<=def.currentPage + def.adjacents;counter++){
                    if(counter===def.currentPage) pagination +=  '<span class="current">'+counter+'</span>';
                    else pagination +=  '<a data-page="'+counter+'" href="'+href(counter)+'">'+counter+'</a>';
                }
            pagination +=  pts,
            pagination +=  '<a data-page="'+lpm1+'" href="'+href(lpm1)+'">'+lpm1+'</a>',
            pagination +=  '<a data-page="'+lastpage+'" href="'+href(lastpage)+'">'+lastpage+'</a>';
            //close to end only hide early pages
            }else{
            pagination +=  '<a data-page="1" href="'+href(1)+'">1</a>',
            pagination +=  '<a data-page="2" href="'+href(2)+'">2</a>',
            pagination +=  pts;
                for(counter = (lastpage - (1 + (def.adjacents * 3))); counter<=lastpage; counter++){
               if(counter === def.currentPage) pagination +=  '<span class="current">'+counter+'</span>';
                    else pagination +=  '<a data-page="'+counter+'" href="'+href(counter)+'">'+counter+'</a>';
                }
            }
        }
        //last and next button
        if(def.currentPage < lastpage){
            def.ifShowPrevNext  && (pagination +=  '<a class="pagenext" data-page="'+next+'" href="'+href(next)+'">'+def.wordNext+'</a>');
            def.ifShowFirstLast && (pagination +=  '<a class="pagelast" data-page="'+lastpage+'" href="'+href(lastpage)+'">'+def.wordLast+'</a>');
        }else{
            def.ifShowPrevNext  && (pagination +=  '<span class="pagenext disabled">'+def.wordNext+'</span>');
            def.ifShowFirstLast && (pagination +=  '<span class="pagelast disabled">'+def.wordLast+'</span>');
        }

        def.ifShowSelect && (pagination += selects);

        pagination += '</div>';
    }
    else if(lastpage===1){
        if (!def.whenLteOnePageIfReturnEmpty) {
            pagination += '<div class="pagination">';
            def.ifShowFirstLast && (pagination += '<span class="pagefirst disabled">' + def.wordFirst + '</span>');
            def.ifShowPrevNext  && (pagination += '<span class="pageprev disabled">' + def.wordPrev + '</span>');
            pagination += '<span class="current">1</span>';
            def.ifShowPrevNext  && (pagination += '<span class="pagenext disabled">' + def.wordNext + '</span>');
            def.ifShowFirstLast && (pagination += '<span class="pagelast disabled">' + def.wordLast + '</span>');
            pagination += '</div>';
        }
    }
    var ret=new String(pagination);
    ret.totalPage=lastpage;
    ret.selectHtml=selects;
    ret.currentPage=def.currentPage;
    ret.pageSize=def.pageSize;
    ret.totalItems=totalItems;
    return ret;
}

    var pages=getPagination(20,{currentPage:1,ifShowSelect:true});
    //console.log(''+pages);
    //console.log(pages.totalPage);
    //console.log(pages.selectHtml);
    document.getElementById('a').innerHTML=pages;

</script>

</body>
</html>
```
{% endfold %}